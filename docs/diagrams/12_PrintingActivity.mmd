%% PrintingActivity - Receipt Printing Screen
%% Path: app/src/main/java/br/com/ticpass/pos/presentation/printing/PrintingActivity.kt

flowchart TB
    subgraph Activity["PrintingActivity"]
        PA["PrintingActivity.kt<br/><i>extends AppCompatActivity</i>"]
    end

    subgraph ViewModel["ViewModel Layer"]
        PrintVM["PrintingViewModel"]
    end

    subgraph Coordination["Coordination Layer"]
        Coord["PrintingActivityCoordinator"]
        DM["PrintingDialogManager"]
        EH["PrintingEventHandler"]
    end

    subgraph Views["Custom Views"]
        QueueView["PrintingQueueView"]
    end

    subgraph Models["Printing Models"]
        Methods["SystemPrintingMethod<br/><i>ACQUIRER | MP_4200_HS | MPT_II</i>"]
        Supported["SupportedPrintingMethods"]
        ProcType["PrintingProcessorType"]
    end

    subgraph SDK["Acquirer SDK"]
        AcqSDK["AcquirerSdk.initialize()"]
    end

    subgraph Utils["Utilities"]
        UIUtils["PrintingUIUtils"]
    end

    subgraph Dialogs["Dialogs"]
        ProgDialog["Progress Dialog<br/><i>dialog_printing_progress.xml</i>"]
    end

    subgraph Layout["Layout"]
        XML["activity_printing_processing.xml"]
        MethodsContainer["printing_methods_container<br/><i>Dynamic buttons</i>"]
        StartBtn["btn_start_processing"]
        ClearBtn["clear_list"]
    end

    %% ViewModel Flow
    PA -->|"observes"| PrintVM
    PA -->|"enqueuePrinting"| PrintVM
    PA -->|"startProcessing"| PrintVM
    PA -->|"cancelPrinting"| PrintVM
    PA -->|"abortPrinting"| PrintVM

    %% Coordination
    PA --> Coord
    Coord --> DM
    Coord --> EH
    Coord --> QueueView

    %% SDK
    PA -->|"onCreate"| AcqSDK

    %% Printing Methods
    PA -->|"generates buttons"| Supported
    Supported --> Methods
    Methods --> ProcType

    %% Utils
    PA --> UIUtils

    %% Dialogs
    PA --> ProgDialog

    %% Layout
    PA --> XML
    XML --> MethodsContainer
    XML --> StartBtn
    XML --> ClearBtn
    XML --> QueueView

    %% Styling
    classDef activity fill:#4CAF50,stroke:#2E7D32,color:white
    classDef viewmodel fill:#9C27B0,stroke:#6A1B9A,color:white
    classDef coordination fill:#00BCD4,stroke:#00838F,color:white
    classDef view fill:#2196F3,stroke:#1565C0,color:white
    classDef model fill:#607D8B,stroke:#37474F,color:white
    classDef sdk fill:#F44336,stroke:#C62828,color:white
    classDef util fill:#FFC107,stroke:#FF8F00,color:black
    classDef dialog fill:#E91E63,stroke:#AD1457,color:white
    classDef layout fill:#9E9E9E,stroke:#616161,color:white

    class PA activity
    class PrintVM viewmodel
    class Coord,DM,EH coordination
    class QueueView view
    class Methods,Supported,ProcType model
    class AcqSDK sdk
    class UIUtils util
    class ProgDialog dialog
    class XML,MethodsContainer,StartBtn,ClearBtn layout
