%% LoginPosActivity - POS Terminal Selection Screen
%% Path: app/src/main/java/br/com/ticpass/pos/presentation/login/activities/LoginPosActivity.kt

flowchart TB
    subgraph Activity["LoginPosActivity"]
        LPA["LoginPosActivity.kt<br/><i>extends AppCompatActivity</i>"]
    end

    subgraph ViewModel["ViewModel Layer"]
        PosVM["LoginPosViewModel.kt"]
    end

    subgraph States["UI States"]
        PosState["LoginPosUiState<br/><i>Loading | Success | Empty | Error</i>"]
    end

    subgraph UseCases["Domain Layer - UseCases"]
        GetPosUC["GetPosByMenuUseCase"]
        RefreshPosUC["RefreshPosListUseCase"]
    end

    subgraph Repository["Repository Layer"]
        PosRepo["PosRepository"]
    end

    subgraph Adapters["UI Adapters"]
        PosAdapter["LoginPosAdapter"]
    end

    subgraph Fragments["Fragments"]
        LoadingFrag["LoginLoadingFragment"]
    end

    subgraph Models["Domain Models"]
        PosModel["Pos<br/><i>id, prefix, sequence, commission</i>"]
    end

    subgraph Utils["Utilities"]
        SPM["SessionPrefsManagerUtils"]
    end

    subgraph Navigation["Navigation"]
        LCA["LoginConfirmActivity"]
    end

    subgraph Layout["Layout"]
        XML["activity_login_pos.xml"]
        RV["pos_recycler_view<br/><i>GridLayoutManager(3)</i>"]
    end

    %% ViewModel Flow
    LPA -->|"observes"| PosVM
    PosVM -->|"emits"| PosState

    %% UseCase Flow
    PosVM -->|"calls"| GetPosUC
    PosVM -->|"calls"| RefreshPosUC

    %% Repository
    GetPosUC --> PosRepo
    RefreshPosUC --> PosRepo

    %% UI
    LPA --> PosAdapter
    PosAdapter -->|"displays"| PosModel
    LPA -->|"shows while loading"| LoadingFrag

    %% Session Storage
    LPA -->|"reads menuId"| SPM
    LPA -->|"saves posId, posName, commission"| SPM

    %% Navigation
    LPA -->|"pos selected"| LCA

    %% Layout
    LPA --> XML
    XML --> RV

    %% Styling
    classDef activity fill:#4CAF50,stroke:#2E7D32,color:white
    classDef viewmodel fill:#9C27B0,stroke:#6A1B9A,color:white
    classDef state fill:#FF9800,stroke:#E65100,color:white
    classDef usecase fill:#00BCD4,stroke:#00838F,color:white
    classDef repository fill:#795548,stroke:#4E342E,color:white
    classDef adapter fill:#E91E63,stroke:#AD1457,color:white
    classDef fragment fill:#2196F3,stroke:#1565C0,color:white
    classDef model fill:#607D8B,stroke:#37474F,color:white
    classDef util fill:#FFC107,stroke:#FF8F00,color:black
    classDef navigation fill:#8BC34A,stroke:#558B2F,color:white
    classDef layout fill:#9E9E9E,stroke:#616161,color:white

    class LPA activity
    class PosVM viewmodel
    class PosState state
    class GetPosUC,RefreshPosUC usecase
    class PosRepo repository
    class PosAdapter adapter
    class LoadingFrag fragment
    class PosModel model
    class SPM util
    class LCA navigation
    class XML,RV layout
